$(document).bind("ad:load",function(b,c,a,f,e){b=$("#"+e).parent();b.length&&"in-article"==c&&(c=b.find("a.lightbox"),b={iframe:!0,transition:"fade",fastIframe:!1,fixed:!0,onOpen:function(){$("#colorbox").addClass("sponsored")},onClosed:function(){$("#colorbox").removeClass("sponsored")}},a=c.data("lightboxWidth"),f=c.data("lightboxHeight"),a&&(b.width=a),f&&(b.height=f),c.colorbox(b))});
$(document).ready(function(){function b(a){$(a).val().toLowerCase()==$(a).attr("longdesc").toLowerCase()&&($(a).val(""),$(a).removeClass("label"))}function c(a){""==$(a).val().toLowerCase()&&($(a).val($(a).attr("longdesc")),$(a).addClass("label"))}$.browser.msie&&9>$.browser.msie.version&&$lis.hover(function(){$(this).addClass("hovered")},function(){$(this).removeClass("hovered")});$("#nav-social .search-icon").each(function(){var a=null;$(this).hover(function(){null!==a&&(window.clearTimeout(a),
a=null);$(this).addClass("hovered")},function(){if(null===a){var b=this;a=window.setTimeout(function(){$(b).removeClass("hovered");b=null},500)}})});adFunctions();setTimeout("adFunctions()",250);setTimeout("adFunctions()",1E3);setTimeout("adFunctions()",3E3);$("#search #query").val("SEARCH OUR SITE").focus(function(){"SEARCH OUR SITE"==$(this).val()&&$(this).val("")}).blur(function(){""==$(this).val()&&$(this).val("SEARCH OUR SITE")});$("a.tab").click(function(){$("#searched").toggle();$("#emailed").toggle();
return!1});$("form.labeled input:text").focus(function(){b(this)});$(".labeled").submit(function(){$(this).find("input:text").each(function(){b(this)})});$("form.labeled input:text").blur(function(){c(this)});$("form.labeled input:text").each(function(){c(this)});$(".expandingMenu .expandingArrow").click(function(){var a=!0;!0==$(this).hasClass("open")&&(a=!1);$(".expandingMenu .expandingContent").slideUp(80);$(".expandingMenu .expandingArrow").removeClass("open");!0==a&&($(this).parent().find(".expandingContent").slideDown(80),
$(this).addClass("open"));return!1});$(".expandingMenu .expandingContent a").click(function(){$(this).parent().parent().parent().find(".expandingTitle").html("Loading...")});$("html").click(function(){$(".expandingMenu .expandingContent").slideUp(80);$(".expandingMenu .expandingArrow").removeClass("open")});$(".print").click(function(){window.open($(".print").attr("href"),"","width=800,height=480,scrollbars,resizable,location=no,menubar=no,toolbar=no");return!1});$(".authorEmail").length&&$(".authorEmail").each(function(){$(this).attr("href",
$(this).attr("href").replace(" at ","@"))});if(0<$("#ourLatestPost").length){window.latestOffset=0;latestPostWidth=335;(new Image).src="http://cdn.theatlantic.com/static/front/images/loadingSmall.gif";$("#ourLatestPost .nextEntryLink").live("click",function(){window.latestOffset++;$(".promoColumn #olpEntry"+window.latestOffset+"  .nextEntryLink").addClass("olpLoading");var b="/widget/recent/"+$("#olpEntry"+window.latestOffset+" .justInUnixDate").html()+"/"+window.latestOffset;$.getJSON(b,{},function(a){$("#ourLatestPost #olpScroll").append(Utf8.decode(a.output));
$("#ourLatestPost #olpScroll").animate({marginLeft:"-="+latestPostWidth+"px"},800);$(".promoColumn #olpEntry"+window.latestOffset+" .nextEntryLink").removeClass("olpLoading")});1==window.latestOffset&&$("#olp1 .previousEntryLink").fadeIn();a();return!1});$("#ourLatestPost .previousEntryLink").live("click",function(){1<=window.latestOffset&&(window.latestOffset--,$("#ourLatestPost #olpScroll").animate({marginLeft:"+="+latestPostWidth+"px"},800));a();return!1});$("#olpEntry1 .previousEntryLink").unbind("click");
var a=function(){window.clearTimeout(window.latestPostRefresh);window.latestPostRefresh=setTimeout(function(){$.getJSON("/widget/recent/",{},function(b){$(b.output).find(".justInUnixDate").html()>$("#olpEntry1 .justInUnixDate").html()&&(window.latestOffset=0,$("#ourLatestPost #olpScroll").animate({marginLeft:"0px"},1E3,function(){$("#ourLatestPost #olpScroll").html(b.output)}));a()})},3E5)};$("#ourLatestPost").length&&a()}$("#inFocusPage .articleContent").first().css("min-height","260px");var f=(new Date).getTime();
if(window.ChineseWrap){var e=function(a,b){b.innerHTML=ChineseWrap.wrapTags(b.innerHTML)};$(".articleContent").each(e);$("h1.headline").each(e);$(".hasChinese.postContent").each(e);$(".hasChinese h3.headline").each(e)}e=(new Date).getTime();window.loadTimes&&window.loadTimes.js&&(loadTimes.js.chinese_wrap=(e-f)/1E3)});function cm8_collapse(){$(".adPush").animate({height:"66px"},500)}function cm8_click(){location.href=$("#FLASH_AD param[name='href']").val()}
function cm8_expand(){$(".adPush").animate({height:"418px"},500)}function FLASH_AD_DoFSCommand(b){"cm8_click"==b?cm8_click():"cm8_collapse"==b?cm8_collapse():"cm8_expand"==b&&cm8_expand()}$(".relatedContentVideo .relatedArrowRight").click(function(){$("#relatedSlideshow").position().left>-(143*($("#relatedSlideshow li").length-4))&&$("#relatedSlideshow").animate({left:"-=143"},{duration:1E3,queue:!1});return!1});
$(".relatedContentVideo .relatedArrowLeft").click(function(){0>$("#relatedSlideshow").position().left&&$("#relatedSlideshow").animate({left:"+=143"},{duration:1E3,queue:!1});return!1});function adFunctions(){$(".ad").each(function(b,c){var a=$(c).hasClass("adInterstitial");$(c).find("img").each(function(b,e){$(e).attr("src")&&-1!=$(e).attr("src").search("grey.gif")&&(a?$(e).hide():($(c).hasClass("adBottomboxleft")&&$(c).parent().hide(),$(c).height(0),$(c).addClass("adNotLoaded")))})})}
"object"!=typeof window.Atlantic&&(window.Atlantic={});
(function(){Atlantic.getMaxAdChildSize=function(b,a){a||(a={});for(var f={width:0,height:0},e="img embed div a object table iframe".split(" "),g=[],d=[],k=0;k<e.length;k++)for(var j=e[k],j=$(b).find(j),h=0;h<j.length;h++){var m=j[h],n=$(m).width(),m=$(m).height();if(1==a[n+"x"+m])return{width:n,height:m};g.push(n);d.push(m)}g.length&&d.length&&(f.width=Math.max.apply(Math,g),f.height=Math.max.apply(Math,d));return f};Atlantic.parseDartScriptSz=function(b){b=b.attr("src");if(!b)return[];var a=b.indexOf("sz=");
if(-1==a)return[];var f=b.slice(a).indexOf(";");return b.slice(a+3,-1==f?b.length:a+f).split(/,/)};var b=function(b,a,f,e,g){if("string"==typeof b){b=b.split(/\./);for(var d=0,k=b[d],j=window[k];"object"==typeof j&&d<b.length-1;)d++,k=b[d],j=j[k];b=j}"function"==typeof b&&(g="object"==typeof g&&g.length?g[0]:null,b.apply(g,[a,f,e,g]))};Atlantic.getAdSize=function(c,a,f){f||(f=0);var e="ad"+c.charAt(0).toUpperCase()+c.slice(1);if($("."+e).length){var g=$("."+e);if(-1<g.html().search("grey.gif"))b(a,
"failure",void 0,void 0);else{var d=Atlantic.parseDartScriptSz($("#"+e+"Script")),k={};$.each(d,function(a,b){k[b]=1});var j=Atlantic.getMaxAdChildSize(g),e=j.width,j=j.height;if(1==k[e+"x"+j])d="success";else if(1==k["0x0"]&&1<e&&1<j)d="success";else if(!d.length&&1<e&&1<j)d="success";else if(20<f&&0<e&&0<j)d="success";else if(20<f)d="failure";else{setTimeout(function(){Atlantic.getAdSize(c,a,f+1)},250);return}"failure"==d&&(j=e=void 0);b(a,d,e,j,g)}}else b(a,"failure",void 0,void 0)}})();
var Utf8={decode:function(b){for(var c="",a=0,f=c1=c2=0;a<b.length;)f=b.charCodeAt(a),128>f?(c+=String.fromCharCode(f),a++):191<f&&224>f?(c2=b.charCodeAt(a+1),c+=String.fromCharCode((f&31)<<6|c2&63),a+=2):(c2=b.charCodeAt(a+1),c3=b.charCodeAt(a+2),c+=String.fromCharCode((f&15)<<12|(c2&63)<<6|c3&63),a+=3);return c}};window.Atlantic=window.Atlantic||{};window.Atlantic.Omniture=window.Atlantic.Omniture||{};
$(function(){function b(a,b,f){switch(b){case "@":return $(a).attr(f);case "t":return f?$(f).text():$(a).text();case "l":return window.location[f];case "$":return a=$(a),f&&(a=a.parents(f).slice(0,1)),a.index();case "r":return f;default:return void 0!==window.console&&window.console.log&&console.log("Invalid command `"+b+"`."),""}}function c(a){for(var b;"HTML"!==a.tagName;){b=$(a).attr("data-omni-click");if(void 0!==b)break;a=a.parentNode}if(/^inherit/.test(b)){var f=a.parentNode;b=/inherit:(.*)/.exec(b);
null!==b&&(f=$(b),f=0===f.length?document.body:f[0]);b=c(f).expr}return{elem:a,expr:b}}Atlantic.Omniture.trackLink=/_debug_omniture/.test(window.location.search)?function(a){alert("Omniture test:"+a);return!1}:function(a,b,f){"undefined"===typeof b&&(b=!1);var c=function(){try{if(!0===b){var f=s_gi(s_account);f.events="event1";f.tl(!0,"o",a)}else Atlantic.Utils.createCookie("omni_click",a)}catch(c){window.console&&window.console.log&&console.log("Omniture Error "+c)}};f?window.setTimeout(c,10):c();
return!0};var a,f=/(@)([^,]+)|(e|r)'([^']+)'|(l|w).([\w]+)|(\$|t)([^,]*)/;a=function(a){for(var b=[];;){var c=f.exec(a);if(null===c)return b;for(var e=1;e<c.length;e+=2)if(c[e]){b.push([c[e],c[e+1]]);break}a=a.substr(c[0].length+1)}};var e=RegExp("^(((http|https):|())//"+document.location.host+"|([.]{0,2})/[^/])","i");$(document.body).on("click omniclick.omniture","[data-omni-click]",function(f){var d=c(f.target),k=d.elem,d=d.expr;if(void 0!==d&&!("A"!==k.tagName&&!0!==f.isTrigger)){var j=a(d),d=
!1;void 0!==$(f.target).closest("a").attr("href")&&(d=null===$(f.target).closest("a").attr("href").match(e));for(var h=[],m=0;m<j.length;m++)h.push(b.call(f.target,k,j[m][0],j[m][1]));k=h.join("`");Atlantic.Omniture.trackLink(k,d,!1)||(f.preventDefault(),f.stopPropagation())}})});$(document).ready(function(){if(0!==$(".post-list").length){var b=$(".post-list").height(),c=$(".post-list").offset(),a=$(".post-list li").eq(8).offset(),f=$(".post-list li").eq(16).offset(),e=[{offset:0,height:a.top-c.top},{offset:a.top-c.top,height:f.top-a.top},{offset:f.top-c.top,height:b-f.top+c.top}],g=0;$(".post-list-container").height(e[g].height);var d=function(a){$(".post-list").animate({"margin-top":-1*e[a].offset},500);$(".post-list-container").animate({height:e[a].height})};$(".up-arrow").on("click",
function(){g=(3+--g%3)%3;d(g);return!1});$(".down-arrow").on("click",function(){g=++g%3;d(g);return!1})}});$(document).ready(function(){$("#module-sticky").stickyRail($("#module-sticky").parent(),$("#footer-wrapper"))});$(".article-content a.lightbox").colorbox({maxWidth:$(window).width()-50,maxHeight:$(window).height()-50,closeButton:!1});$(document).ready(function(){$("aside.callout").each(function(b,c){var a=$(c);a.attr("data-omni-click","r'moreon',r'"+b+"',r'"+s.prop49+"'");a.find("a").attr("data-omni-click","inherit")})});(function(b){function c(){b.fn.ajaxSubmit.debug&&(window.console&&window.console.log)&&window.console.log("[jquery.form] "+Array.prototype.join.call(arguments,""))}b.fn.ajaxSubmit=function(a){function f(){function f(){if(!q++){l.detachEvent?l.detachEvent("onload",f):l.removeEventListener("load",f,!1);var a=!0;try{if(t)throw"timeout";var c,d;d=l.contentWindow?l.contentWindow.document:l.contentDocument?l.contentDocument:l.document;if((null==d.body||""==d.body.innerHTML)&&!x){x=1;q--;setTimeout(f,100);
return}h.responseText=d.body?d.body.innerHTML:null;h.responseXML=d.XMLDocument?d.XMLDocument:d;h.getResponseHeader=function(a){return{"content-type":e.dataType}[a]};if("json"==e.dataType||"script"==e.dataType){var g=d.getElementsByTagName("textarea")[0];h.responseText=g?g.value:h.responseText}else if("xml"==e.dataType&&!h.responseXML&&null!=h.responseText){d=h;var j=h.responseText,g=void 0;window.ActiveXObject?(g=new ActiveXObject("Microsoft.XMLDOM"),g.async="false",g.loadXML(j)):g=(new DOMParser).parseFromString(j,
"text/xml");d.responseXML=g&&g.documentElement&&"parsererror"!=g.documentElement.tagName?g:null}c=b.httpData(h,e.dataType)}catch(r){a=!1,b.handleError(e,h,"error",r)}a&&(e.success(c,"success"),m&&b.event.trigger("ajaxSuccess",[h,e]));m&&b.event.trigger("ajaxComplete",[h,e]);m&&!--b.active&&b.event.trigger("ajaxStop");e.complete&&e.complete(h,a?"success":"error");setTimeout(function(){k.remove();h.responseXML=null},100)}}var c=j[0];if(b(":input[name=submit]",c).length)alert('Error: Form elements must not be named "submit".');
else{var e=b.extend({},b.ajaxSettings,a),d=b.extend(!0,{},b.extend(!0,{},b.ajaxSettings),e),g="jqFormIO"+(new Date).getTime(),k=b('<iframe id="'+g+'" name="'+g+'" src="about:blank" />'),l=k[0];k.css({position:"absolute",top:"-1000px",left:"-1000px"});var h={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;k.attr("src","about:blank")}},m=e.global;m&&
!b.active++&&b.event.trigger("ajaxStart");m&&b.event.trigger("ajaxSend",[h,e]);if(d.beforeSend&&!1===d.beforeSend(h,d))d.global&&b.active--;else if(!h.aborted){var q=0,t=0;if(d=c.clk){var r=d.name;r&&!d.disabled&&(a.extraData=a.extraData||{},a.extraData[r]=d.value,"image"==d.type&&(a.extraData[name+".x"]=c.clk_x,a.extraData[name+".y"]=c.clk_y))}setTimeout(function(){var d=j.attr("target"),r=j.attr("action");c.setAttribute("target",g);"POST"!=c.getAttribute("method")&&c.setAttribute("method","POST");
c.getAttribute("action")!=e.url&&c.setAttribute("action",e.url);a.skipEncodingOverride||j.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});e.timeout&&setTimeout(function(){t=!0;f()},e.timeout);var h=[];try{if(a.extraData)for(var m in a.extraData)h.push(b('<input type="hidden" name="'+m+'" value="'+a.extraData[m]+'" />').appendTo(c)[0]);k.appendTo("body");l.attachEvent?l.attachEvent("onload",f):l.addEventListener("load",f,!1);c.submit()}finally{c.setAttribute("action",r),d?c.setAttribute("target",
d):j.removeAttr("target"),b(h).remove()}},10);var x=0}}}if(!this.length)return c("ajaxSubmit: skipping submit process - no element selected"),this;"function"==typeof a&&(a={success:a});var e=this.attr("action")||window.location.href,e=(e.match(/^([^#]+)/)||[])[1];a=b.extend({url:e||"",type:this.attr("method")||"GET"},a||{});e={};this.trigger("form-pre-serialize",[this,a,e]);if(e.veto)return c("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,
a))return c("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var g=this.formToArray(a.semantic);if(a.data){a.extraData=a.data;for(var d in a.data)if(a.data[d]instanceof Array)for(var k in a.data[d])g.push({name:d,value:a.data[d][k]});else g.push({name:d,value:a.data[d]})}if(a.beforeSubmit&&!1===a.beforeSubmit(g,this,a))return c("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[g,this,a,e]);if(e.veto)return c("ajaxSubmit: submit vetoed via form-submit-validate trigger"),
this;d=b.param(g);"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?"&":"?")+d,a.data=null):a.data=d;var j=this,h=[];a.resetForm&&h.push(function(){j.resetForm()});a.clearForm&&h.push(function(){j.clearForm()});if(!a.dataType&&a.target){var m=a.success||function(){};h.push(function(f){b(a.target).html(f).each(m,arguments)})}else a.success&&h.push(a.success);a.success=function(b,f){for(var c=0,e=h.length;c<e;c++)h[c].apply(a,[b,f,j])};d=b("input:file",this).fieldValue();k=!1;for(e=0;e<d.length;e++)d[e]&&
(k=!0);a.iframe||k?a.closeKeepAlive?b.get(a.closeKeepAlive,f):f():b.ajax(a);this.trigger("form-submit-notify",[this,a]);return this};b.fn.ajaxForm=function(a){return this.ajaxFormUnbind().bind("submit.form-plugin",function(){b(this).ajaxSubmit(a);return!1}).each(function(){b(":submit,input:image",this).bind("click.form-plugin",function(a){var c=this.form;c.clk=this;if("image"==this.type)if(void 0!=a.offsetX)c.clk_x=a.offsetX,c.clk_y=a.offsetY;else if("function"==typeof b.fn.offset){var g=b(this).offset();
c.clk_x=a.pageX-g.left;c.clk_y=a.pageY-g.top}else c.clk_x=a.pageX-this.offsetLeft,c.clk_y=a.pageY-this.offsetTop;setTimeout(function(){c.clk=c.clk_x=c.clk_y=null},10)})})};b.fn.ajaxFormUnbind=function(){this.unbind("submit.form-plugin");return this.each(function(){b(":submit,input:image",this).unbind("click.form-plugin")})};b.fn.formToArray=function(a){var c=[];if(0==this.length)return c;var e=this[0],g=a?e.getElementsByTagName("*"):e.elements;if(!g)return c;for(var d=0,k=g.length;d<k;d++){var j=
g[d],h=j.name;if(h)if(a&&e.clk&&"image"==j.type)!j.disabled&&e.clk==j&&c.push({name:h+".x",value:e.clk_x},{name:h+".y",value:e.clk_y});else if((j=b.fieldValue(j,!0))&&j.constructor==Array)for(var m=0,n=j.length;m<n;m++)c.push({name:h,value:j[m]});else null!==j&&"undefined"!=typeof j&&c.push({name:h,value:j})}if(!a&&e.clk){a=e.getElementsByTagName("input");d=0;for(k=a.length;d<k;d++)g=a[d],(h=g.name)&&(!g.disabled&&"image"==g.type&&e.clk==g)&&c.push({name:h+".x",value:e.clk_x},{name:h+".y",value:e.clk_y})}return c};
b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var c=[];this.each(function(){var e=this.name;if(e){var g=b.fieldValue(this,a);if(g&&g.constructor==Array)for(var d=0,k=g.length;d<k;d++)c.push({name:e,value:g[d]});else null!==g&&"undefined"!=typeof g&&c.push({name:this.name,value:g})}});return b.param(c)};b.fn.fieldValue=function(a){for(var c=[],e=0,g=this.length;e<g;e++){var d=b.fieldValue(this[e],a);null===d||("undefined"==typeof d||d.constructor==
Array&&!d.length)||(d.constructor==Array?b.merge(c,d):c.push(d))}return c};b.fieldValue=function(a,b){var c=a.name,g=a.type,d=a.tagName.toLowerCase();"undefined"==typeof b&&(b=!0);if(b&&(!c||a.disabled||"reset"==g||"button"==g||("checkbox"==g||"radio"==g)&&!a.checked||("submit"==g||"image"==g)&&a.form&&a.form.clk!=a||"select"==d&&-1==a.selectedIndex))return null;if("select"==d){var k=a.selectedIndex;if(0>k)return null;for(var c=[],d=a.options,j=(g="select-one"==g)?k+1:d.length,k=g?k:0;k<j;k++){var h=
d[k];if(h.selected){var m=h.value;m||(m=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value);if(g)return m;c.push(m)}}return c}return a.value};b.fn.clearForm=function(){return this.each(function(){b("input,select,textarea",this).clearFields()})};b.fn.clearFields=b.fn.clearInputs=function(){return this.each(function(){var a=this.type,b=this.tagName.toLowerCase();"text"==a||"password"==a||"textarea"==b?this.value="":"checkbox"==a||"radio"==a?this.checked=!1:"select"==b&&(this.selectedIndex=
-1)})};b.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};b.fn.enable=function(a){void 0==a&&(a=!0);return this.each(function(){this.disabled=!a})};b.fn.selected=function(a){void 0==a&&(a=!0);return this.each(function(){var c=this.type;"checkbox"==c||"radio"==c?this.checked=a:"option"==this.tagName.toLowerCase()&&(c=b(this).parent("select"),a&&(c[0]&&"select-one"==c[0].type)&&c.find("option").selected(!1),
this.selected=a)})}})(jQuery);window.Atlantic=window.Atlantic||{};window.Atlantic.social={};$(document).on("social:share",function(b,c){var a,f;a="NA";if(void 0!==c.el)if(f=$(c.el),void 0!==f.attr("data-omni-click"))f.click();else{f=f.closest(".article-tools");var e=$("body").hasClass("article")?"article":"misc";f.hasClass("vertical")?a="top":f.hasClass("horizontal")&&(a="bottom");a=e+c.type+"`"+a+"`"+document.URL;window.Atlantic.Omniture.trackLink(a)}});var toggleShareMenu=function(b){$(b.currentTarget).toggleClass("active")};
$(document).on("touchstart",".more-btn-container",toggleShareMenu);Atlantic.social.googlePlusClick=function(b){"on"===b.state&&$(document).trigger("social:share",[{type:"google",action:"plus",url:b.href,el:void 0}])};Atlantic.social.twitterClick=function(b){$.event.trigger("social:share.tweet",[{type:"twitter",action:b.type,el:b.target.parentNode}])};Atlantic.social.facebookClick=function(b,c){$.event.trigger("social:share",[{type:"fb",action:"like",url:b,el:c}])};
Atlantic.social.linkedInClick=function(b){$(document).trigger("social:share",[{type:"linkedin",action:"share",url:b,el:void 0}])};void 0!==window.twttr&&twttr.ready(function(b){b.events.bind("tweet",Atlantic.social.twitterClick)});if(!window.FB||!window.FB.Event){var oldFbAsyncInit=window.fbAsyncInit?window.fbAsyncInit:function(){};window.fbAsyncInit=function(){oldFbAsyncInit();FB.Event.subscribe("edge.create",Atlantic.social.facebookClick)}}else FB.Event.subscribe("edge.create",Atlantic.social.facebookClick);
$(document).ready(function(){window.addthis&&addthis.addEventListener("addthis.menu.share",function(){$(document).trigger("social:share",[{type:"addthis",action:"share",url:void 0,el:void 0}])})});window["Atlantic.social.googlePlusClick"]=Atlantic.social.googlePlusClick;window["Atlantic.social.linkedInClick"]=Atlantic.social.linkedInClick;window.Atlantic=window.Atlantic||{};Atlantic.Promos=Atlantic.Promos||{};
Atlantic.Promos.CircSlider=Class.extend({$article:$("#article"),cookie_name:"seen_circ_slider",debug:/debug_circ_slider=1/.test(window.location.search),header_image:Atlantic.STATIC_PATH+"images/circ/slider/survey-15-top.png",body_image:null,init:function(){if(0===this.$article.length||Atlantic.Utils.readCookie(this.cookie_name)&&!this.debug)return!1;this.body_image=Atlantic.STATIC_PATH+"images/circ/slider/survey-15-bottom-a.png";this.link="https://w1.buysub.com/servlet/OrdersGateway?cds_mag_code=ATL&cds_page_id=172711&cds_response_key=I15A2W";
_.bindAll(this,"render","toggleOpen");this.render();this.bindEvents();this.hideTimeout=window.setTimeout(this.toggleOpen,3E4);!0!==Atlantic.DEBUG&&Atlantic.Utils.createCookie(this.cookie_name,!0,7)},bindEvents:function(){$(document).on("click",".circ-slider-module .top",this.toggleOpen.bind(this));$(document).on("click",".circ-slider-module .close",this.remove.bind(this))},render:function(){var b=['<aside class="circ-slider-module"><i class="close"></i>','<img class="top" src="'+this.header_image+
'">','<a href="'+this.link+'" target="_blank">','<img class="full" src="'+this.body_image+'">',"</a></aside>"].join("");this.$module=$(b);$("body").append(this.$module);_gaq.push(["_trackEvent","CircSlider","displayed"]);return this},remove:function(){window.clearTimeout(this.hideTimeout);this.$module.hide()},toggleOpen:function(){window.clearTimeout(this.hideTimeout);void 0===this._minimized_bottom&&(this._minimized_bottom=-1*this.$module.find("img.full").height(),this._is_minimized=!1);var b=this._is_minimized?
0:this._minimized_bottom;this._is_minimized=!this._is_minimized;this.$module.animate({bottom:b},200);_gaq.push(["_trackEvent","CircSlider",this._is_minimized?"collapsed":"expanded"])}});Atlantic.Promos.circslider=new Atlantic.Promos.CircSlider;(function(){if(void 0===window.disqus_shortname)window.console&&window.console.error("Disqus name is not defined.");else{var b=document.createElement("script");b.async=!0;b.type="text/javascript";b.src="http://"+disqus_shortname+".disqus.com/count.js";b.onload=b.onreadystatechange=function(){if(void 0===window.DISQUSWIDGETS)return!1;window.DISQUSWIDGETS.displayCount=function(b){for(var a,f,e,g,d=b.counts.length-1;0<=d;d--)a=b.counts[d],f=a.comments,0<f&&$('[data-disqus-identifier="'+a.id+'"]').each(function(a,
b){e=1===f?$(b).attr("data-disqus-format-singular")||$(b).attr("data-disqus-format"):$(b).attr("data-disqus-format");void 0!==e&&(g=e.replace("{}",f),$(b).html(g))})}};(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(b)}})();(function(b){if(void 0===window.disqus_shortname)return window.console&&console.error("disqus_shortname must be defined."),!1;var c=b("#disqus_thread");if(!c.length)return!1;var a=function(){if(!window.DISQUS){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}};if("#disqus_thread"===window.location.hash||0===window.location.hash.indexOf("#comment-"))a();
else b(window).on("scroll.lazy_comments",_.debounce(function(){var f=window.screen.height+(window.pageYOffset||document.documentElement.scrollTop);c.offset().top<f&&(b(window).off(".lazy_comments"),a())},100))})(jQuery);window.Atlantic=window.Atlantic||{};Atlantic.SimpleShare=Atlantic.SimpleShare||{};
Atlantic.SimpleShare.networks={facebook:function(b){if("undefined"===typeof FB)Atlantic.SimpleShare.openWindow({url:_.template("https://www.facebook.com/sharer/sharer.php?u=<%= url %>"),width:626,height:436},b);else{var c={method:"feed",display:"popup",link:b.url},a={title:"name",dek:"description",image:"picture"},f;for(f in a)b[f]&&(c[a[f]]=b[f]);FB.ui(c)}},twitter:{url:_.template("https://twitter.com/share?text=<%= text %>&url=<%= url %><% if (via) { %>&via=<%= via %><% } %>"),width:600,height:250},
googleplus:{url:_.template("https://plus.google.com/share?url=<%= url %>"),width:500,height:600},linkedin:{url:_.template("http://www.linkedin.com/shareArticle?mini=true&url=<%= url %>"),width:520,height:570},reddit:{url:_.template("https://www.reddit.com/submit?url=<%= url %>"),width:900,height:600},instapaper:{sameWindow:!0,url:_.template("http://www.instapaper.com/hello2?url=<%= url %>"),width:900,height:600},pocket:{url:_.template("https://getpocket.com/edit.php?url=<%= url %>"),width:900,height:600},
tumblr:{url:_.template("https://www.tumblr.com/share/link?url=<%= url %><% if (text) { %>&name=<%= text %><% } %>"),width:900,height:600},pinterest:{url:_.template("http://www.pinterest.com/pin/create/button/?url=<%= url %>&description=<%= text %><% if (image) { %>&media=<%= image %><% } %>"),width:900,height:600},whatsapp:{url:_.template("whatsapp://send?text=<%=text + ' ' + url %>"),width:900,height:600},email:function(b){var c="The Atlantic";window.location.host.match("citylab.com")&&(c="CityLab");
window.location.href="mailto:?subject="+c+": "+b.text+"&body=Read this:%0A"+b.url},print:function(){window.print()}};Atlantic.SimpleShare.openWindow=function(b,c){var a=b.url(c);b.sameWindow?window.location.href=a:window.open(a,"share","width="+b.width+",height="+b.height+",top=100,left=100")};
(function(b){b(document).on("click tap","[data-share]",function(){var c=b(this),a=c.data("share"),a=Atlantic.SimpleShare.networks[a],c={url:c.data("shareUrl")||window.location.href,text:c.data("shareText")||document.title,title:c.data("shareTitle"),via:c.data("shareVia"),dek:c.data("shareDescription"),image:c.data("shareImage")};"function"===typeof a?a(c):"object"===typeof a&&Atlantic.SimpleShare.openWindow(a,c);return!1})})(jQuery);!function(){function b(a,b,c){"addEventListener"in window?a.addEventListener(b,c,!1):"attachEvent"in window&&a.attachEvent("on"+b,c)}function c(a){l.log&&"object"==typeof console&&console.log(n+"[Host page"+y+"]"+a)}function a(a){c(" Size reset requested by "+("init"===a.type?"host page":"iFrame"));null===p&&(p={x:void 0!==window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop},c(" Get position: "+
p.x+","+p.y));e(function(){f(a);g("reset","reset",a.iframe)},a,"init")}function f(a){function b(d){a.iframe.style[d]=a[d]+"px";c(" IFrame ("+a.iframe.id+") "+d+" set to "+a[d]+"px")}l.sizeHeight&&b("height");l.sizeWidth&&b("width")}function e(a,b,d){d!==b.type&&v?(c(" Requesting animation frame"),v(a)):a()}function g(a,b,d){c("["+a+"] Sending msg to iframe ("+b+")");d.contentWindow.postMessage(n+b,"*")}function d(){var d=this,f,e=d.id;f=(""===e&&(d.id=e="iFrameResizer"+h++,c(" Added missing iframe ID: "+
e+" ("+d.src+")")),e);c(" IFrame scrolling "+(l.scrolling?"enabled":"disabled")+" for "+f);d.style.overflow=!1===l.scrolling?"hidden":"auto";d.scrolling=!1===l.scrolling?"no":"yes";e=function(a){1/0!==l[a]&&0!==l[a]&&(d.style[a]=l[a]+"px",c(" Set "+a+" = "+l[a]+"px"))};e("maxHeight");e("minHeight");e("maxWidth");e("minWidth");("number"==typeof l.bodyMargin||"0"===l.bodyMargin)&&(l.bodyMarginV1=l.bodyMargin,l.bodyMargin=""+l.bodyMargin+"px");var j=f+":"+l.bodyMarginV1+":"+l.sizeWidth+":"+l.log+":"+
l.interval+":"+l.enablePublicMethods+":"+l.autoResize+":"+l.bodyMargin+":"+l.heightCalculationMethod+":"+l.bodyBackground+":"+l.bodyPadding+":"+l.tolerance;b(d,"load",function(){var b=m;g("iFrame.onload",j,d);!b&&l.heightCalculationMethod in A&&a({iframe:d,height:0,width:0,type:"init"})});g("init",j,d)}function k(a){if("object"!=typeof a)throw new TypeError("Options is not an object.");}function j(){function a(b){if("IFRAME"!==b.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+
b.tagName+">.");d.call(b)}return function(b,c){var d;d=b||{};k(d);for(var e in w)w.hasOwnProperty(e)&&(l[e]=d.hasOwnProperty(e)?d[e]:w[e]);Array.prototype.forEach.call(document.querySelectorAll(c||"iframe"),a)}}var h=0,m=!0,n="[iFrameSizer]",z=n.length,y="",p=null,v=window.requestAnimationFrame,A={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},l={},w={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,enablePublicMethods:!1,heightCalculationMethod:"offset",
interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,closedCallback:function(){},initCallback:function(){},messageCallback:function(){},resizedCallback:function(){}},u,q=["moz","webkit","o","ms"];for(u=0;u<q.length&&!v;u+=1)v=window[q[u]+"RequestAnimationFrame"];v||c(" RequestAnimationFrame not supported");b(window,"message",function(b){function d(){e(function(){f(h);null!==p&&(window.scrollTo(p.x,p.y),c(" Set position: "+p.x+","+
p.y),p=null);l.resizedCallback(h)},h,"resetPage")}function g(a){var b=Number(l["max"+a]),d=Number(l["min"+a]),e=a.toLowerCase(),f=Number(h[e]);if(d>b)throw Error("Value for min"+a+" can not be greater than max"+a);c(" Checking "+e+" is in range "+d+"-"+b);d>f&&(f=d,c(" Set "+e+" to min value"));f>b&&(f=b,c(" Set "+e+" to max value"));h[e]=""+f}var j=b.data,h={};if(n===(""+j).substr(0,z)){c(" Received: "+j);var k=j.substr(z).split(":"),h={iframe:document.getElementById(k[0]),id:k[0],height:k[1],width:k[2],
type:k[3]};g("Height");g("Width");k=h.type in{"true":1,"false":1};if(!(k&&c(" Ignoring init message from meta parent page"),k)){if(null===h.iframe)throw Error("iFrame ("+h.id+") does not exist on "+y);var k=b.origin,q=h.iframe.src.split("/").slice(0,3).join("/");if(l.checkOrigin&&(c(" Checking connection is from: "+q),"null"!=""+k&&k!==q))throw Error("Unexpected message received from: "+k+" for "+h.iframe.id+". Message was: "+b.data+". This error can be disabled by adding the checkOrigin: false option.");
switch(h.type){case "close":b=h.iframe;j=b.id;c(" Removing iFrame: "+j);b.parentNode.removeChild(b);l.closedCallback(j);c(" --");l.resizedCallback(h);break;case "message":b=j.substr(j.indexOf(":")+7+6);c(" MessageCallback passed: {iframe: "+h.iframe.id+", message: "+b+"}");l.messageCallback({iframe:h.iframe,message:b});c(" --");break;case "scrollTo":crollRequestFromChild();break;case "reset":a(h);break;case "init":d();l.initCallback(h.iframe);break;default:d()}m=!1}}});if("jQuery"in window){var t=
jQuery;t.fn.iFrameResize=function(a){return k(a),l=t.extend({},w,a),this.filter("iframe").each(d).end()}}"function"==typeof define&&define.amd?define(function(){return j()}):window.iFrameResize=j()}();(function(b){function c(a){try{return a[0].contentWindow.document.body.scrollHeight}catch(b){return null}}function a(){for(var a=window.pageYOffset||document.documentElement.scrollTop,g=0;g<f.length;g++)if("absolute"===f.eq(g).css("position")){var d=f.eq(g),k=d.parent();k.css({height:0,"padding-bottom":0});var j=c(d);!j&&window.iFrameResize&&(d.iFrameResize({minHeight:d.attr("height")||0}),j=d.height());j&&k.css({paddingBottom:0,height:j,"max-height":j})}else d=f.eq(g),d.css({height:null}),(k=c(d))&&
k>d.attr("height")?d.height(k):window.iFrameResize&&b("iframe.auto-relow").iFrameResize({minHeight:d.attr("height")||0});window.scrollTo(0,a)}var f=b("iframe.auto-reflow");f.length&&(f.on("load",_.debounce(a,500)),b(window).on("resize",_.debounce(a,500)),b(document).on("ready",a))})(window.jQuery);window.Atlantic=window.Atlantic||{};
window.Atlantic.FacebookSlider=Class.extend({cookieName:"hide_facebook_slider",body_image:window.Atlantic.STATIC_URL+"theatlantic/promos/facebook-slider/tile-icon-thin-serifs.png",body_link:"https://www.facebook.com/theatlantic",fb_code:'<div class="fb-like" data-href="https://facebook.com/theatlantic" data-width="100" data-layout="button_count" data-action="like" data-show-faces="false" data-share="false"></div>',template:function(){return['<div id="facebook-slider">','<header><span class="close">Close</span></header>',
"<h2>Get <i>The Atlantic</i> on Facebook</h2>",'<div class="like-btn">','<img src="'+this.body_image+'">','<h3><a href="'+this.body_link+'">The Atlantic</a></h3>',this.fb_code,"</div>",'<p class="opt-out">','<input type="checkbox"> ',"Please don't show me this again","</p>","</div>"]},init:function(b){this.$articleEl=$(b).eq(0);this.checkIsShowable()&&(this.render(),this.bindEvents())},checkIsShowable:function(){var b=/debug_facebook_slider/.test(window.location.search),c=/utm_source=FB/.test(window.location.search),
a=null!==window.Atlantic.Utils.readCookie(this.cookieName),f=0<this.$articleEl.length;return b||c&&!a&&f},setTransformPosition:function(){this.transformPosition=this.$articleEl.height()+this.$articleEl.offset().top-0.85*$(window).height()},loadFacebook:function(){if(void 0===window.FB){var b,c=document.getElementsByTagName("script")[0];document.getElementById("facebook-jssdk")||(b=document.createElement("script"),b.id="facebook-jssdk",b.src="//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=100770816677686&version=v2.0",
c.parentNode.insertBefore(b,c))}},render:function(){var b=this.template();this.$slider=$(b.join(""));$("body").append(this.$slider);this.loadFacebook()},bindEvents:function(){var b=this;this.setTransformPosition();$(window).on("resize",this.setTransformPosition.bind(this));b.shownSlider=!1;$(window).on("scroll",function(){window.pageYOffset>b.transformPosition&&!b.shownSlider&&(window.Atlantic.Utils.createCookie(b.cookieName,1,7),b.$slider.addClass("active"),b.shownSlider=!0)});this.$slider.on("click touch touchstart",
".opt-out",b.hidePermanently.bind(this));this.$slider.on("click touch touchstart","header",function(){b.$slider.removeClass("active")});var c=function(){window.FB.Event.subscribe("edge.create",function(){b.hidePermanently();b.trackLike()})};window.FB?c():window.fbAsyncInit=c},hidePermanently:function(){this.$slider.removeClass("active");window.Atlantic.Utils.createCookie(this.cookieName,1,365)},trackLike:function(){var b=window.s,c=window.location.pathname.split("/").reverse()[1];b.prop74=b.prop33;
b.tl(!0,"o","liked-facebook-slider`"+c)}});$(document).on("ready",function(){window.fbslider=new window.Atlantic.FacebookSlider($(".article-content, .blog-content"))});
